var FbListOrder=new Class({Extends:FbListPlugin,initialize:function(b){this.parent(b);document.ondragstart=function(){return false};var a=this.getList().list;a.setStyle("position","relative");if(typeOf(a.getElement("tbody"))!=="null"){a=a.getElement("tbody")}if(this.options.handle!==false&&a.getElements(this.options.handle).length===0){fconsole("order: handle selected ("+this.options.handle+") but not found in container");return}this.sortable=new Sortables(a,{clone:true,constrain:false,revert:true,opacity:0.7,transition:"elastic:out",handle:this.options.handle,onComplete:function(c,d){d?d.removeClass("fabrikDragSelected"):c.removeClass("fabrikDragSelected");this.neworder=this.getOrder();Fabrik.loader.start("list_"+this.options.ref,"sorting",true);new Request({url:"index.php",data:{option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"order",g:"list",listref:this.options.ref,method:"ajaxReorder",order:this.neworder,origorder:this.origorder,dragged:this.getRowId(c),listid:this.options.listid,orderelid:this.options.orderElementId,direction:this.options.direction},onComplete:function(e){Fabrik.loader.stop("list_"+this.options.ref,null,true);this.origorder=this.neworder}.bind(this)}).send()}.bind(this),onStart:function(c,d){this.origorder=this.getOrder();d?d.addClass("fabrikDragSelected"):c.addClass("fabrikDragSelected")}.bind(this)});if(b.enabled===false){fconsole("drag n drop reordering not enabled - need to order by ordering element");this.sortable.detach()}else{if(this.options.handle){a.getElements(this.options.handle).setStyle("cursor","move")}else{a.getChildren().setStyle("cursor","move")}}},getRowId:function(a){return typeOf(a.getProperty("id"))==="null"?null:a.getProperty("id").replace("list_"+this.options.ref+"_row_","")},getOrder:function(){return(this.sortable.serialize(0,function(a){return this.getRowId(a)}.bind(this))).clean()}});